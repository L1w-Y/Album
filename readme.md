# Qt6 相册项目

## 📖 项目简介

**Album** 是一个基于 Qt6 框架开发的桌面应用程序，旨在帮助用户管理和浏览照片相册。它提供了丰富的功能，包括项目管理、照片预览、幻灯片播放等，同时通过响应式 UI 和多线程操作，确保流畅的用户体验。

本文档对项目中的主要类及其功能进行总结，描述了它们的关联和使用情况。每个类都在构建一个无缝且易用的用户体验中发挥了重要作用。

---

## 🛠 类功能概述

### **QMainWindow**
**QMainWindow** 类是应用程序的主界面，负责管理主窗口，包括菜单项的交互和核心应用逻辑。

#### 功能：
1. 主界面显示为左侧文件列表框和右侧图片展示区，内部包含 **ProTree**（目录树类）和 **PicShow**（图片展示类）的指针。
2. 处理菜单项并将菜单项与点击逻辑关联。
3. 支持打开和创建相册项目。
4. 使用 `map` 结构管理所有项目：
    - **创建项目**：为新项目创建指定文件夹。
    - **打开项目**：直接打开指定的文件夹。

---

### **向导类 Wizard**
**Wizard** 类提供创建新项目的向导流程，继承自 **QWizard**，并重写了 `done` 函数。

#### 功能：
1. 用户操作完成后发送 `SigProSettings` 信号给 **ProTree** 类。
2. 包含两个向导页面：
   - **ProSetPage**：允许用户输入项目名称和路径，支持选择文件夹功能，并通过重写 `isComplete` 函数检测输入是否合法（如路径是否存在、项目名称是否重复）。
   - **ConfirmPage**：确认用户操作，支持取消以终止项目创建流程。

---

### **目录树类 ProTree**
**ProTree** 类负责管理主界面左侧的目录树，支持项目管理和交互。

#### 功能：
1. 接收 **Wizard** 类发送的 `SigProSettings` 信号，将项目添加到目录树中。
2. 通过右键菜单导入文件，弹出文件导入对话框以选择文件。
3. 设置活动项目，选中的项目会高亮显示并字体加粗。
4. 幻灯片播放功能，依次播放目录树下的每张图片。
5. 集成自定义的 **ProTreeWidget** 类型，支持高级菜单操作。

#### 主要成员：
- `Ui::ProTree *ui`：管理 **ProTree** 的 UI 类。
- `AddProToTree`：连接 `SigProSettings` 信号，在目录树中创建项目文件夹。
- `GetTreeWidget`：返回 **ProTreeWidget** 对象的指针。

---

### **目录树 UI 类 ProTreeWidget**
**ProTreeWidget** 是 **QTreeWidget** 的自定义实现，用于管理目录列表，集成在 **ProTree** 的 UI 文件中。

#### 功能：
1. 包含 `_set_path` 集合，用于防止重复导入相同项目（基于路径和项目名的组合字符串）。
2. 支持右键点击生成弹出菜单，菜单项包括导入文件、关闭项目、幻灯片播放、设为活动项目等。
3. 响应导入和创建项目信号，启动线程（**OpenTreeThread** 和 **ProTreeThread**）以提升性能。
4. 文件导入和项目创建时更新进度条对话框，支持中途取消。
5. 双击目录树条目以显示图片，或通过右侧切换按钮进行图片切换。
6. 处理主界面发送的音乐设置请求。

#### 主要成员：
- `_set_path`：缓存目录树中的项目名。
- `_action_import`：导入文件动作。
- `_action_setstart`：设置活动项动作。
- `_action_closepro`：关闭项目动作。
- `SlotItemPressed`：右键点击的槽函数，用于弹出菜单。
- `_dialog_progress`：文件导入进度条对话框。

---

### **ProTreeThread 类**
**ProTreeThread** 类继承自 **QThread**，用于处理耗时的操作（如导入图片文件）。

#### 功能：
1. 响应外部中止消息。
2. 通过信号通知进度更新（`SigUpdateProgress`）和完成状态（`SigFinishProgress`）。

#### 主要成员：
- `_src_path`：文件源路径。
- `_dist_path`：文件目标路径。
- `_file_count`：已复制文件数。
- `_bstop`：是否停止操作。

---

### **OpenTreeThread 类**
**OpenTreeThread** 类与 **ProTreeThread** 类类似，用于处理打开现有项目或文件夹的操作，其功能与结构几乎相同。

---

### **动画类 PicAnimationWid**
**PicAnimationWid** 类负责幻灯片播放中的动画效果。

#### 功能：
1. 通过修改图片 alpha 值实现渐隐渐显的过渡效果。
2. 支持图片播放、更新选择及前后切换。
3. 重写 `paintEvent` 实现双缓冲绘图。

#### 主要成员：
- `SetPixmap`：设置播放的图片。
- `SlideNext` & `SlidePre`：向前和向后切换图片的槽函数。
- `TimeOut`：定时切换图片的槽函数。

---

### **PicShow 类**
**PicShow** 类管理右侧的图片显示区域，处理按钮动画和图片切换。

#### 功能：
1. 实现按钮的渐隐渐显效果。
2. 更新显示的图片（`SlotUpdatePic`）。
3. 更新选中的条目（`SlotSelectItem`）。

---

## 总结
**Album** 应用程序通过强大的 Qt6 框架提供了流畅的照片管理体验。它的模块化类架构确保了可维护性，同时支持高级功能，如多线程操作、幻灯片播放和响应式 UI 元素。

该项目展示了如何利用多线程、自定义 UI 组件和 Qt 的信号槽机制构建现代桌面应用程序。
